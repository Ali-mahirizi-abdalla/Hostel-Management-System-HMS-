{% extends 'hms/base.html' %}
{% load static %}

{% block title %}Daily Report - HMS{% endblock %}

{% block extra_css %}
<style>
    @media print {

        .navbar,
        .btn,
        .no-print {
            display: none !important;
        }

        body {
            background: white;
            color: black;
        }

        .glass-card {
            border: 1px solid #ccc;
            background: white;
        }
    }

    .report-header {
        text-align: center;
        padding: var(--spacing-lg);
        border-bottom: 2px solid var(--glass-border);
        margin-bottom: var(--spacing-lg);
    }

    .summary-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: var(--spacing-md);
        margin-bottom: var(--spacing-lg);
    }

    .summary-item {
        background: rgba(99, 102, 241, 0.1);
        padding: var(--spacing-md);
        border-radius: var(--radius-md);
        text-align: center;
    }

    .summary-value {
        font-size: 2rem;
        font-weight: 700;
        color: var(--primary-light);
    }

    .summary-label {
        color: var(--text-secondary);
        font-size: 0.9rem;
        margin-top: var(--spacing-xs);
    }
</style>
{% endblock %}

{% block content %}
<div class="glass-card">
    <div class="report-header">
        <h1 style="margin-bottom: var(--spacing-xs);">üçΩÔ∏è Daily Meal Report</h1>
        <h2 style="color: var(--text-secondary); font-size: 1.5rem;">{{ meal_date|date:"l, F d, Y" }}</h2>
        <p style="color: var(--text-muted); margin-top: var(--spacing-sm);">Generated at {{ now|date:"g:i A" }}</p>
    </div>

    <div class="summary-grid">
        <div class="summary-item">
            <div class="summary-value">{{ breakfast_count }}</div>
            <div class="summary-label">Breakfast</div>
        </div>
        <div class="summary-item">
            <div class="summary-value">{{ lunch_count }}</div>
            <div class="summary-label">Lunch</div>
        </div>
        <div class="summary-item">
            <div class="summary-value">{{ supper_count }}</div>
            <div class="summary-label">Supper</div>
        </div>
        <div class="summary-item" style="background: rgba(245, 158, 11, 0.1);">
            <div class="summary-value" style="color: var(--warning);">{{ early_breakfast_count }}</div>
            <div class="summary-label">Early Breakfast</div>
        </div>
    </div>

    <div style="margin-top: var(--spacing-lg);">
        <h3 style="margin-bottom: var(--spacing-md);">Detailed Breakdown</h3>

        {% if confirmations %}
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="background: rgba(99, 102, 241, 0.1); border-bottom: 2px solid var(--glass-border);">
                    <th style="padding: var(--spacing-sm); text-align: left;">#</th>
                    <th style="padding: var(--spacing-sm); text-align: left;">Student</th>
                    <th style="padding: var(--spacing-sm); text-align: left;">Room</th>
                    <th style="padding: var(--spacing-sm); text-align: center;">Breakfast</th>
                    <th style="padding: var(--spacing-sm); text-align: center;">Lunch</th>
                    <th style="padding: var(--spacing-sm); text-align: center;">Supper</th>
                    <th style="padding: var(--spacing-sm); text-align: center;">Early B/F</th>
                </tr>
            </thead>
            <tbody>
                {% for conf in confirmations %}
                <tr style="border-bottom: 1px solid var(--glass-border);">
                    <td style="padding: var(--spacing-sm);">{{ forloop.counter }}</td>
                    <td style="padding: var(--spacing-sm); font-weight: 600;">{{ conf.student.user.get_full_name }}</td>
                    <td style="padding: var(--spacing-sm);">{{ conf.student.room_number }}</td>
                    <td style="padding: var(--spacing-sm); text-align: center;">
                        {% if conf.breakfast %}‚úÖ{% else %}‚ùå{% endif %}
                    </td>
                    <td style="padding: var(--spacing-sm); text-align: center;">
                        {% if conf.lunch %}‚úÖ{% else %}‚ùå{% endif %}
                    </td>
                    <td style="padding: var(--spacing-sm); text-align: center;">
                        {% if conf.supper %}‚úÖ{% else %}‚ùå{% endif %}
                    </td>
                    <td style="padding: var(--spacing-sm); text-align: center;">
                        {% if conf.early_breakfast_needed %}‚è∞{% else %}‚Äî{% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <div class="text-center" style="padding: var(--spacing-xl);">
            <p class="text-muted">No meal confirmations for this date</p>
        </div>
        {% endif %}
    </div>
</div>

<div class="mt-3 no-print">
    <a href="{% url 'hms:kitchen_dashboard' %}" class="btn btn-secondary">‚Üê Back to Dashboard</a>
    <button onclick="window.print()" class="btn btn-primary">üñ®Ô∏è Print Report</button>
</div>

{% endblock %}